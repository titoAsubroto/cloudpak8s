{"componentChunkName":"component---src-pages-integration-cp-4-i-deploy-mq-index-mdx","path":"/integration/cp4i-deploy-mq/","result":{"pageContext":{"frontmatter":{"title":"MQ","description":"Basic guide for deploying the Messaging","keywords":"ibm, install, integration, messaging, mq, queue manager"},"relativePagePath":"/integration/cp4i-deploy-mq/index.mdx","titleType":"page","MdxNode":{"id":"78a69ee5-3dd2-5ee8-928c-c6dc73d541cd","children":[],"parent":"3bec2ffa-b39b-532c-829b-7fb88c5d9c4c","internal":{"content":"---\ntitle: MQ\ndescription: Basic guide for deploying the Messaging\nkeywords: 'ibm, install, integration, messaging, mq, queue manager'\n---\n\nThis page provides the guidance for installing MQ for Red Hat\nOpenShift both on-prem and on IBM Cloud.\n\n### Make sure permissions are set\n\nYou can open up permissions for install in you `mq` namespace by issing\nthe following commands:\n\n```\noc adm policy add-scc-to-group ibm-anyuid-scc system:serviceaccounts:mq\noc adm policy add-scc-to-group anyuid system:serviceaccounts:mq\n```\n\n### Create MQ instance in Cloud Pak for Integration\n\n1. Create an instance of MQ queue manager by clicking on “Add new instance” in the MQ tile in Platform Navigator.\n   ![Add New Instance](/assets/img/integration/deploy-queue-manager/5.mq-nav.png)\n2. This will open a pop up window showing requirements for deploying MQ.\nClick **Continue**.\n3. This will open the MQ helm chart to deploy MQ to the cluster.\nClick **Overview** to review the requirements to deploy MQ chart.\n5. Unless you require fine grained rights to be defined for your\ninstallation, the default rbac settings defined on install will be\nsufficient.\n8.\tMQ also requires Storage class or Persistent volume to be pre-defined\nif persistence is being used. It is possible to deploy MQ chart without\nusing persistence. However, it is highly recommended to use persistent\nstorage as any changes you make in the MQ UI will be lost if the pods were\nrecreated.\n9. If you are using the entitled registry, your image pull secret will\nalready be created for you as `ibm-entitlement-key`.\n9.\tIf you are not using entitled registry, obtain an image pull secret\nusing the command below:\n\n    To obtain the secret for pulling the image login to the OCP CLI and run:\n    ```\n    oc get secrets -n mq\n    ```\n    The pull secret starts with **deployer-dockercfg**\n\n10.\tAfter performing the above pre-requisites, click on **Configuration**\ntab to provide the values required to deploy MQ chart.\n\n11.\tProvide the name for the chart, select **mq** as Target namespace and\nselect **local-cluster** as Target-Cluster. Also check the ‘License’ box\nto accept license.\n12. Expand the 'Quick Start' twisty to expose the Configuration Settings\nfor TLS.\n    ![](/assets/img/integration/deploy-queue-manager/6.mq-quickstart.png)\n12.\tSet the Cluster Hostname as the proxy node address for your installation.  Omit the `https://` in the url.\n13. Next, click to expand ‘All parameters’ to configure the chart for\ndeployment.\n13.\tUntickthe box “Production usage” box.  Double check your image\nrepository is correct.  For entitled registry it will look like\n`cp.icr.io/ibm-mqadvanced-server-integration`.\n14. Set the `Image Pull Secret` to `ibm-entitlement-key` for the entitled\nregistry or the **deployer-dockercfg** value specific to your environment\nas indicated in the step above.\n14.\tMoving down, under the `IBM Cloud Pak for Integration` heading it will\nask for the location of your platform navigator is installed at.  In most\ninstallations, this will be the `integration` namespace, but check to be\nsure.\n15.\tMoving down, under the `TLS` -> `Configuration Settings for TLS`.\nTick the `Generate Certificate` box. The cluster hostname value should\nalready be populated with the proxy node value defined earlier.\n16. Under the `Persistence` heading.  If you choose to use persistent\nstorage then you will need to tick both the `Enable persistence` and\n`Use dynamic provisioning` boxes.\n17. Under the `Data PVC` heading.  Populate the `Storage Class name` with\nthe requisite storageclass.  Use `oc get storageclasses` to get a list on\nyour system.  If you are using IBM Cloud this can be the `ibmc-file-bronze`.\nEither way, file storage (not block) is required for use with MQ.\n18. There is no need to repeat this for the other sections (Log PVC and QM\nPVC etc) for a dev environment.  If you want to use a separate storage\nclass for these items, you can individually specify the storageclasses as\nrequired.\n19. Moving down, under Security, ensure the check box for\n`Initialize volume as root` is ticked.  This is the default.\n20. Last item to configure is to enable OD Tracing for the MQ instance.\nAt the bottom of the MQ Chart you will find the\n`Operation Dashboard Configuration`.\n![](/assets/img/integration/deploy-queue-manager/11.tracingchart.png)\n21. Click the Tick Box for `Enable Operations Dashboard`\n22. At the bottom, populate the `OD tracing instance namespace` with the\nname of the tracing namespace, which in this sample is `tracing`\n23. Scroll to the bottom and then click install.\n\n### Monitoring the Deployment\n1. Once all the pods are up, it will resemble the following.  Use the\n`oc get pods` command to view the pods in flight\n![](/assets/img/integration/deploy-queue-manager/12.mqpods.png)\n\n### Register with Tracing Service\n1. Near the end of the install of MQ, a job will be created that has the\nname `odtracing.registration`.  This job will not complete until the\nRegistration is completed inside of the Tracing capability.\n2. What will happen is that a request will be created inside of tracing\nthat you need to act upon.  Navigate to the Platform Navigator and via\nthe Hamburger menu select Tracing and then when the window pops out\nselect the name of your tracing instance which should be called\n`tracing`\n![](/assets/img/integration/deploy-queue-manager/13.tracing-nav.png)\n3. Within tracing, select the `Manage` icon from the menu.  Looks like a\ncog wheel.\n![](/assets/img/integration/deploy-queue-manager/14.tracing-from-menu.png)\n4. Click on the `Registration Requests` icon.\n5. You should see a new registration request for your MQ install.\nClick the `approve` link\n6. You will see a pop up window with some lines to copy to your clipboard.\nClick the 2 boxes icon in the top right icon to copy the commands required.\n![](/assets/img/integration/deploy-queue-manager/15.process-request.png)\n7. Ensuring you have an active `oc` session and in the `mq` project.\nPaste the commands to the window and it will run then and finish the\nprocessing.\n8. If you are slow in doing the steps above.  It is possible you might\nsee the `odtracing.registration` job fail.  No worries.  Once you complete\nthe pasting of the commands to create your secret, the job will re-create\nitself.\n","type":"Mdx","contentDigest":"cef65de8427d98ce5db4804ad12bcf34","counter":258,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"MQ","description":"Basic guide for deploying the Messaging","keywords":"ibm, install, integration, messaging, mq, queue manager"},"exports":{},"rawBody":"---\ntitle: MQ\ndescription: Basic guide for deploying the Messaging\nkeywords: 'ibm, install, integration, messaging, mq, queue manager'\n---\n\nThis page provides the guidance for installing MQ for Red Hat\nOpenShift both on-prem and on IBM Cloud.\n\n### Make sure permissions are set\n\nYou can open up permissions for install in you `mq` namespace by issing\nthe following commands:\n\n```\noc adm policy add-scc-to-group ibm-anyuid-scc system:serviceaccounts:mq\noc adm policy add-scc-to-group anyuid system:serviceaccounts:mq\n```\n\n### Create MQ instance in Cloud Pak for Integration\n\n1. Create an instance of MQ queue manager by clicking on “Add new instance” in the MQ tile in Platform Navigator.\n   ![Add New Instance](/assets/img/integration/deploy-queue-manager/5.mq-nav.png)\n2. This will open a pop up window showing requirements for deploying MQ.\nClick **Continue**.\n3. This will open the MQ helm chart to deploy MQ to the cluster.\nClick **Overview** to review the requirements to deploy MQ chart.\n5. Unless you require fine grained rights to be defined for your\ninstallation, the default rbac settings defined on install will be\nsufficient.\n8.\tMQ also requires Storage class or Persistent volume to be pre-defined\nif persistence is being used. It is possible to deploy MQ chart without\nusing persistence. However, it is highly recommended to use persistent\nstorage as any changes you make in the MQ UI will be lost if the pods were\nrecreated.\n9. If you are using the entitled registry, your image pull secret will\nalready be created for you as `ibm-entitlement-key`.\n9.\tIf you are not using entitled registry, obtain an image pull secret\nusing the command below:\n\n    To obtain the secret for pulling the image login to the OCP CLI and run:\n    ```\n    oc get secrets -n mq\n    ```\n    The pull secret starts with **deployer-dockercfg**\n\n10.\tAfter performing the above pre-requisites, click on **Configuration**\ntab to provide the values required to deploy MQ chart.\n\n11.\tProvide the name for the chart, select **mq** as Target namespace and\nselect **local-cluster** as Target-Cluster. Also check the ‘License’ box\nto accept license.\n12. Expand the 'Quick Start' twisty to expose the Configuration Settings\nfor TLS.\n    ![](/assets/img/integration/deploy-queue-manager/6.mq-quickstart.png)\n12.\tSet the Cluster Hostname as the proxy node address for your installation.  Omit the `https://` in the url.\n13. Next, click to expand ‘All parameters’ to configure the chart for\ndeployment.\n13.\tUntickthe box “Production usage” box.  Double check your image\nrepository is correct.  For entitled registry it will look like\n`cp.icr.io/ibm-mqadvanced-server-integration`.\n14. Set the `Image Pull Secret` to `ibm-entitlement-key` for the entitled\nregistry or the **deployer-dockercfg** value specific to your environment\nas indicated in the step above.\n14.\tMoving down, under the `IBM Cloud Pak for Integration` heading it will\nask for the location of your platform navigator is installed at.  In most\ninstallations, this will be the `integration` namespace, but check to be\nsure.\n15.\tMoving down, under the `TLS` -> `Configuration Settings for TLS`.\nTick the `Generate Certificate` box. The cluster hostname value should\nalready be populated with the proxy node value defined earlier.\n16. Under the `Persistence` heading.  If you choose to use persistent\nstorage then you will need to tick both the `Enable persistence` and\n`Use dynamic provisioning` boxes.\n17. Under the `Data PVC` heading.  Populate the `Storage Class name` with\nthe requisite storageclass.  Use `oc get storageclasses` to get a list on\nyour system.  If you are using IBM Cloud this can be the `ibmc-file-bronze`.\nEither way, file storage (not block) is required for use with MQ.\n18. There is no need to repeat this for the other sections (Log PVC and QM\nPVC etc) for a dev environment.  If you want to use a separate storage\nclass for these items, you can individually specify the storageclasses as\nrequired.\n19. Moving down, under Security, ensure the check box for\n`Initialize volume as root` is ticked.  This is the default.\n20. Last item to configure is to enable OD Tracing for the MQ instance.\nAt the bottom of the MQ Chart you will find the\n`Operation Dashboard Configuration`.\n![](/assets/img/integration/deploy-queue-manager/11.tracingchart.png)\n21. Click the Tick Box for `Enable Operations Dashboard`\n22. At the bottom, populate the `OD tracing instance namespace` with the\nname of the tracing namespace, which in this sample is `tracing`\n23. Scroll to the bottom and then click install.\n\n### Monitoring the Deployment\n1. Once all the pods are up, it will resemble the following.  Use the\n`oc get pods` command to view the pods in flight\n![](/assets/img/integration/deploy-queue-manager/12.mqpods.png)\n\n### Register with Tracing Service\n1. Near the end of the install of MQ, a job will be created that has the\nname `odtracing.registration`.  This job will not complete until the\nRegistration is completed inside of the Tracing capability.\n2. What will happen is that a request will be created inside of tracing\nthat you need to act upon.  Navigate to the Platform Navigator and via\nthe Hamburger menu select Tracing and then when the window pops out\nselect the name of your tracing instance which should be called\n`tracing`\n![](/assets/img/integration/deploy-queue-manager/13.tracing-nav.png)\n3. Within tracing, select the `Manage` icon from the menu.  Looks like a\ncog wheel.\n![](/assets/img/integration/deploy-queue-manager/14.tracing-from-menu.png)\n4. Click on the `Registration Requests` icon.\n5. You should see a new registration request for your MQ install.\nClick the `approve` link\n6. You will see a pop up window with some lines to copy to your clipboard.\nClick the 2 boxes icon in the top right icon to copy the commands required.\n![](/assets/img/integration/deploy-queue-manager/15.process-request.png)\n7. Ensuring you have an active `oc` session and in the `mq` project.\nPaste the commands to the window and it will run then and finish the\nprocessing.\n8. If you are slow in doing the steps above.  It is possible you might\nsee the `odtracing.registration` job fail.  No worries.  Once you complete\nthe pasting of the commands to create your secret, the job will re-create\nitself.\n","fileAbsolutePath":"/home/travis/build/ibm-cloud-architecture/cloudpak8s/src/pages/integration/cp4i-deploy-mq/index.mdx"}}}}